/* ====== ROOT FIX ====== */
:root{
  --bg: #0b0e14;
  --code-1: #FFD64F;
  --code-2: #FFE46B;
  --code-3: #FFF5C7;
  --edit-0: #07080c;
  --edit-1: #0d1018;
  --radius: 18px;
  --shadow-soft: 0 10px 30px rgba(0,0,0,.12);
  --ease-out: cubic-bezier(.18,.84,.26,1);
  --ease-in: cubic-bezier(.78,.12,.86,.28);
  --t-intro: 2800ms;
  --t-merge: 1200ms;
  --t-bloom: 1400ms;
  --t-reveal: 700ms;
}

*{ box-sizing: border-box; }
html, body, #root{ width:100%; height:100%; }

body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif;
  background: #0b0e14;
}

/* 首页保持一屏（stage 1~4） */
.app{
  width:100%;
  height:100vh;
  position:relative;
  isolation:isolate;
  background: var(--bg);
  color: rgba(255,255,255,.92);
  overflow:hidden;
}

/* stage-4：只要底色 + 空屏 */
.app.stage-4{
  background:
    radial-gradient(1200px 700px at 50% 0%, var(--code-2), transparent 70%),
    linear-gradient(180deg, var(--code-3), rgba(255,255,255,.92));
  color:#141414;
}
.stage4-empty{ position:absolute; inset:0; }

/* 分屏 */
.split{
  position:relative;
  height:100vh;
  width:100%;
  overflow:hidden;
}

.panel{
  position:absolute;
  inset:0 auto 0 0;
  width:50%;
  height:100%;
  overflow:hidden;
}
.panel--right{ inset:0 0 0 auto; }

.panel__bg{
  position:absolute;
  inset:-20%;
  transform: scale(1.1);
}
.panel__bg--edit{
  background:
    radial-gradient(1200px 800px at 20% 30%, rgba(120,150,255,.18), transparent 65%),
    radial-gradient(800px 600px at 70% 70%, rgba(255,255,255,.06), transparent 60%),
    linear-gradient(180deg, var(--edit-1), var(--edit-0));
}

.panel__label{
  position:absolute;
  left: clamp(16px, 4vw, 40px);
  bottom: clamp(18px, 4vw, 44px);
  display:flex;
  flex-direction:column;
  gap:6px;
  mix-blend-mode: screen;
  z-index: 50;
}
/* 只让“攀岩”那组文案靠右 */
.panel__label--right{
  left: auto;
  right: clamp(16px, 4vw, 40px);
  text-align: right;
}


.panel__label .title{
  font-size: clamp(18px, 2.4vw, 28px);
  font-weight: 700;
  opacity: .96;
}

/* 中央线 */
.seam{
  position:absolute;
  top:0; left:50%;
  width:1px; height:100%;
  transform: translateX(-.5px);
  z-index: 60;
  pointer-events:none;
}
.seam__line{
  position:absolute; inset:0;
  background: rgba(255,255,255,.18);
  opacity:.45;
}
.seam__core{
  position:absolute;
  left:50%;
  top:50%;
  width:14px; height:14px;
  transform: translate(-50%, -50%);
  border-radius:999px;
  background: rgba(255,255,255,.75);
  box-shadow: 0 0 0 14px rgba(255,255,255,.08), 0 0 40px rgba(255,255,255,.25);
  opacity:0;
}

/* 左：攀岩 */
.climbPhoto{
  position:relative;
  width:100%;
  height:100%;
  background: #0b0e14;
}
.climbPhoto__img{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit: cover;
  transform: scale(1.06);
  filter: saturate(.9) contrast(.95) brightness(.82);
}
.climbPhoto__veil{
  position:absolute;
  inset:0;
  background:
    radial-gradient(900px 700px at 30% 25%, rgba(255,255,255,.10), transparent 60%),
    radial-gradient(900px 700px at 70% 70%, rgba(0,0,0,.55), transparent 62%),
    linear-gradient(90deg, rgba(0,0,0,.38), rgba(0,0,0,.14));
  backdrop-filter: blur(8px);
  opacity: .92;
}

/* ✅ fallback：图片没出来也不会黑屏 */
.climbPhoto.is-fallback::before{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(900px 700px at 30% 25%, rgba(255,255,255,.10), transparent 60%),
    radial-gradient(900px 700px at 70% 70%, rgba(0,0,0,.45), transparent 62%),
    linear-gradient(90deg, rgba(60,90,120,.28), rgba(0,0,0,.10));
}

/* 右：剪辑 */
.edit{ position:relative; width:100%; height:100%; }
.edit__vignette{
  position:absolute; inset:0;
  background:
    radial-gradient(800px 500px at 30% 40%, transparent, rgba(0,0,0,.55) 70%),
    linear-gradient(90deg, rgba(0,0,0,.55), transparent 35%, transparent 65%, rgba(0,0,0,.3));
  opacity:.75;
}

.edit__frames{
  position:relative;
  width:100%;
  height:100%;
}

.shot{
  position:absolute;
  border-radius: 14px;
  overflow:hidden;
  border: 1px solid rgba(255,255,255,.18);
  box-shadow: 0 16px 40px rgba(0,0,0,.25);
  background: rgba(255,255,255,.06);
  opacity:.92;
}
.shot__img{
  width:100%;
  height:100%;
  object-fit: cover;
  transform: scale(1.05);
  filter: saturate(.9) contrast(.92) brightness(.82);
}
.shot__veil{
  position:absolute;
  inset:0;
  background:
    radial-gradient(800px 500px at 30% 20%, rgba(255,255,255,.10), transparent 62%),
    linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.48));
  backdrop-filter: blur(7px);
  opacity:.90;
}

/* 三卡片（像你原来的三个方块那样克制） */
.shot.s1{ width:40%; height:30%; left:12%; top:14%; transform: rotate(-3deg); }
.shot.s2{ width:48%; height:36%; left:34%; top:30%; transform: rotate(2deg); opacity:.78; }
.shot.s3{ width:34%; height:24%; left:18%; top:54%; transform: rotate(-1deg); opacity:.68; }

/* ✅ fallback */
.shot.is-fallback{
  background:
    radial-gradient(500px 280px at 30% 30%, rgba(255,255,255,.08), transparent 60%),
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.28));
}

.edit__timeline{
  position:absolute;
  left: clamp(16px, 4vw, 40px);
  top: clamp(18px, 4vw, 44px);
  width: min(420px, 40vw);
  display:flex;
  flex-direction:column;
  gap:10px;
  opacity:.9;
  z-index: 40;
}
.tl-row{ height:10px; display:flex; gap:8px; opacity:.9; }
.clip{
  display:inline-block;
  height:100%;
  border-radius:999px;
  background: rgba(255,255,255,.16);
  box-shadow: 0 0 0 1px rgba(255,255,255,.05) inset;
}
.c1{ width:22%; } .c2{ width:12%; opacity:.55;} .c3{ width:30%; }
.c4{ width:16%; } .c5{ width:22%; opacity:.55;} .c6{ width:10%; } .c7{ width:18%; }
.c8{ width:28%; opacity:.65;} .c9{ width:14%; } .c10{ width:20%; opacity:.55;}

.edit__playhead{
  position:absolute;
  left: clamp(16px, 4vw, 40px);
  top: calc(clamp(18px, 4vw, 44px) + 38px);
  width: min(420px, 40vw);
  height: 2px;
  z-index: 40;
}
.edit__playhead::before{
  content:"";
  position:absolute;
  left:0; top:-18px;
  width:2px; height:56px;
  background: rgba(255,255,255,.55);
  box-shadow: 0 0 18px rgba(255,255,255,.25);
  animation: playhead 1.1s linear infinite;
  opacity:.75;
}
@keyframes playhead{
  0%{ transform: translateX(0); opacity:.35;}
  40%{ opacity:.9;}
  100%{ transform: translateX(100%); opacity:.35;}
}

/* 编程扩散 */
.code-bloom{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:80;
  opacity:0;
}
.bloom{
  position:absolute;
  left:50%; top:50%;
  width:14px; height:14px;
  transform: translate(-50%, -50%);
  border-radius:999px;
  opacity:0;
}
.bloom--1{ background: var(--code-1); }
.bloom--2{ background: var(--code-2); }
.bloom--3{ background: var(--code-3); }

.grid-hint{
  position:absolute;
  inset:0;
  opacity:0;
  background-image:
    linear-gradient(to right, rgba(20,20,20,.12) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(20,20,20,.12) 1px, transparent 1px);
  background-size: 56px 56px;
  mix-blend-mode: multiply;
}

/* 阶段控制 */
.app.stage-1 .panel--left{ transform: translateX(-6%); }
.app.stage-1 .panel--right{ transform: translateX(6%); }
.app.stage-1 .panel--left,
.app.stage-1 .panel--right{
  transition: transform var(--t-intro) var(--ease-out);
}
.app.stage-1.is-running .panel--left{ transform: translateX(0); }
.app.stage-1.is-running .panel--right{ transform: translateX(0); }

.app.stage-2 .panel--left{ transform: translateX(2.5%); }
.app.stage-2 .panel--right{ transform: translateX(-2.5%); }
.app.stage-2 .panel--left,
.app.stage-2 .panel--right{
  transition: transform var(--t-merge) var(--ease-in);
}
.app.stage-2 .seam__core{
  opacity:1;
  transition: opacity 380ms var(--ease-out);
}

.app.stage-3 .code-bloom{ opacity:1; transition: opacity 200ms linear; }
.app.stage-3 .bloom{
  opacity:1;
  animation: bloom var(--t-bloom) var(--ease-out) forwards;
}
.app.stage-3 .bloom--1{ animation-delay: 0ms; }
.app.stage-3 .bloom--2{ animation-delay: 80ms; }
.app.stage-3 .bloom--3{ animation-delay: 160ms; }

.app.stage-3 .grid-hint{
  opacity:.9;
  transition: opacity var(--t-bloom) var(--ease-out);
}

@keyframes bloom{
  0%{ transform: translate(-50%, -50%) scale(1); filter: blur(0px); }
  100%{ transform: translate(-50%, -50%) scale(220); filter: blur(.6px); }
}

.app.stage-4 .split{
  opacity:0;
  transform: scale(1.02);
  transition: opacity 520ms var(--ease-out), transform 520ms var(--ease-out);
  pointer-events:none;
}
.app.stage-4 .code-bloom{ opacity:0; transition: opacity 420ms var(--ease-out); }
.app.stage-4 .panel__label{ opacity:0; }

/* 卡片浮动 */
.app.stage-1 .shot,
.app.stage-2 .shot{
  animation: floaty 3.4s var(--ease-out) infinite alternate;
}
@keyframes floaty{
  0%{ transform: translateY(0) rotate(var(--r, 0deg)); }
  100%{ transform: translateY(-10px) rotate(var(--r, 0deg)); }
}
.shot.s1{ --r:-3deg; }
.shot.s2{ --r:2deg; }
.shot.s3{ --r:-1deg; }

/* 手机端 */
@media (max-width: 720px){
  .panel{ width:100%; height:50%; }
  .panel--right{ inset:auto 0 0 0; }
  .seam{ left:0; top:50%; width:100%; height:1px; transform: translateY(-.5px); }
  .app.stage-1 .panel--left{ transform: translateY(-6%); }
  .app.stage-1 .panel--right{ transform: translateY(6%); }
  .app.stage-1.is-running .panel--left,
  .app.stage-1.is-running .panel--right{ transform: translateY(0); }
  .app.stage-2 .panel--left{ transform: translateY(2.5%); }
  .app.stage-2 .panel--right{ transform: translateY(-2.5%); }
}
